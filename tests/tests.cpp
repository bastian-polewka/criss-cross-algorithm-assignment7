#include "../src/mul.h"
#include "doctest.h"

TEST_CASE("Constructor") {
  SUBCASE("Empty strings") {
    CHECK_THROWS_WITH(Mul("", ""), "Invalid string inputs");
  }

  SUBCASE("String with minus sign") {
    CHECK_THROWS_WITH(Mul("-12443 ", "999"), "Invalid string inputs");
  }

  SUBCASE("String with non-numeric characters") {
    CHECK_THROWS_WITH(Mul("two ", "32jhl&"), "Invalid string inputs");
  }

  SUBCASE("Numeric strings with spaces") {
    CHECK_NOTHROW(Mul(" 1245 523 3443 ", "999 999 999"));
  }

  SUBCASE("Numeric strings with no spaces") {
    CHECK_NOTHROW(Mul("1442", "99"));
  }

  SUBCASE("Long numeric strings") {
    CHECK_NOTHROW(Mul(string(1000, '9'), string(1000, '5')));
  }

  SUBCASE("Numeric strings with leading zeroes") {
    Mul calc("001324", "00000000");
    CHECK_EQ(calc.getMultiplicand(), "1324");
    CHECK_EQ(calc.getMultiplier(), "0");
  }
}

TEST_CASE("Vedic multiplication") {
  SUBCASE("Single digit multiplication") {
    Mul calc("0", "1");
    CHECK_EQ(calc.vedic(), "0");

    Mul calc1("0", "0");
    CHECK_EQ(calc1.vedic(), "0");

    Mul calc2("9", "9");
    CHECK_EQ(calc2.vedic(), "81");
  }

  SUBCASE("Strings are same length") {
    Mul calc("10", "16");
    CHECK_EQ(calc.vedic(), "160");

    Mul calc1("849", "321");
    CHECK_EQ(calc1.vedic(), "272529");

    Mul calc2("999 639 239", "995 639 737");
    CHECK_EQ(calc2.vedic(), "995280549012840143");
  }

  SUBCASE("Strings are different length") {
    Mul calc("1043", "16");
    CHECK_EQ(calc.vedic(), "16688");

    Mul calc1("943256", "3");
    CHECK_EQ(calc1.vedic(), "2829768");

    Mul calc2("999 639 239", "995");
    CHECK_EQ(calc2.vedic(), "994641042805");
  }

  SUBCASE("Large strings") {
    Mul calc1("999 639 239", "995 639 737");
    CHECK_EQ(calc1.vedic(), "995280549012840143");

    Mul calc2("389257953890572905723057239572952952735027589027523",
              "34872974238375294329049085623563925632564392563290562369");
    CHECK_EQ(calc2.vedic(),
             "13574582598108627114973360345699834051651571386469912043240018567"
             "816426604207069012288725029059644489081987");
    Mul calc3(string(2000, '9'), string(5000, '1'));
    CHECK_EQ(
        calc3.vedic(),
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111110999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999998888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "888888888888888888888888888888888888888888888888888888888888888888888"
        "9");
  }
}

TEST_CASE("Karatsuba multiplication") {
  SUBCASE("Single digit multiplication") {
    Mul calc("0", "1");
    CHECK_EQ(calc.karatsuba(), "0");

    Mul calc1("0", "0");
    CHECK_EQ(calc1.karatsuba(), "0");

    Mul calc2("9", "9");
    CHECK_EQ(calc2.karatsuba(), "81");
  }

  SUBCASE("Strings are same length") {
    Mul calc("10", "16");
    CHECK_EQ(calc.karatsuba(), "160");

    Mul calc1("849", "321");
    CHECK_EQ(calc1.karatsuba(), "272529");

    Mul calc2("999 639 239", "995 639 737");
    CHECK_EQ(calc2.karatsuba(), "995280549012840143");
  }

  SUBCASE("Strings are different length") {
    Mul calc("1043", "16");
    CHECK_EQ(calc.karatsuba(), "16688");

    Mul calc1("943256", "3");
    CHECK_EQ(calc1.karatsuba(), "2829768");

    Mul calc2("999 639 239", "995");
    CHECK_EQ(calc2.karatsuba(), "994641042805");
  }

  SUBCASE("Large strings") {
    Mul calc1("999 639 239", "995 639 737");
    CHECK_EQ(calc1.karatsuba(), "995280549012840143");

    Mul calc2("389257953890572905723057239572952952735027589027523",
              "34872974238375294329049085623563925632564392563290562369");
    CHECK_EQ(calc2.karatsuba(),
             "13574582598108627114973360345699834051651571386469912043240018567"
             "816426604207069012288725029059644489081987");
    Mul calc3(string(2000, '9'), string(5000, '1'));
    CHECK_EQ(
        calc3.karatsuba(),
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111111111111111111111111111111111111"
        "1111111111111111111111111111111111111110999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999999999999999999999999999999999999999999999"
        "9999999999999999999999999999998888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "8888888888888888888888888888888888888888888888888888888888888888888888"
        "888888888888888888888888888888888888888888888888888888888888888888888"
        "9");
  }
}